# frozen_string_literal: true

class Engine::Exploit::Unschedule
  struct :exploit
  delegate :schedule_handle, to: :exploit

  def call
    success! unschedule!
  end

  private

  def unschedule!
    return if schedule_handle.nil? || scheduler_job.nil?

    scheduler_job.kill
  end

  memoize def scheduler_job
    scheduler.job(schedule_handle)
  end

  def scheduler
    Rufus::Scheduler.singleton
  end
end
